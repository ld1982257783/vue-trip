import{c as ae,m as U,n as H,t as ke,h as se,e as oe,r as Je,d as ie,u as Qe,a as l,x as O,I as te,w as le,aG as Ce,az as Le,a2 as Ze,aH as et,aI as tt,U as nt,a0 as Ae,q as N,Q as Re,aJ as at,b as D,f as ot,E as it,k as he,A as ee,C as $e,s as me,aK as we,aL as lt,p as ue,aM as ct,K as Pe,aN as rt,aO as st,at as ut,S as dt,F as ft,_ as gt,au as ht,aa as ve,a6 as be,v as mt,aP as vt,X as Te,ab as pe,ai as Be,ac as A,ad as q,aQ as Me,ag as ye,G as J,an as ne,al as bt,ar as _e,am as xe,aj as yt,y as _t,z as xt}from"./index-84821ee2.js";import{b as Oe,u as De,a as kt,T as Ct}from"./city-24511109.js";import{a as de,u as It}from"./index-2691d4e2.js";const[St,X]=ae("cell"),Ne={tag:U("div"),icon:String,size:String,title:H,value:H,label:H,center:Boolean,isLink:Boolean,border:ke,required:Boolean,iconPrefix:String,valueClass:se,labelClass:se,titleClass:se,titleStyle:null,arrowDirection:String,clickable:{type:Boolean,default:null}},wt=oe({},Ne,Je);var Tt=ie({name:St,props:wt,setup(e,{slots:n}){const a=Qe(),u=()=>{if(n.label||O(e.label))return l("div",{class:[X("label"),e.labelClass]},[n.label?n.label():e.label])},i=()=>{var o;if(n.title||O(e.title)){const h=(o=n.title)==null?void 0:o.call(n);return Array.isArray(h)&&h.length===0?void 0:l("div",{class:[X("title"),e.titleClass],style:e.titleStyle},[h||l("span",null,[e.title]),u()])}},c=()=>{const o=n.value||n.default;if(o||O(e.value))return l("div",{class:[X("value"),e.valueClass]},[o?o():l("span",null,[e.value])])},m=()=>{if(n.icon)return n.icon();if(e.icon)return l(te,{name:e.icon,class:X("left-icon"),classPrefix:e.iconPrefix},null)},v=()=>{if(n["right-icon"])return n["right-icon"]();if(e.isLink){const o=e.arrowDirection&&e.arrowDirection!=="right"?`arrow-${e.arrowDirection}`:"arrow";return l(te,{name:o,class:X("right-icon")},null)}};return()=>{var o;const{tag:h,size:s,center:I,border:b,isLink:x,required:S}=e,E=(o=e.clickable)!=null?o:x,P={center:I,required:S,clickable:E,borderless:!b};return s&&(P[s]=!!s),l(h,{class:X(P),role:E?"button":void 0,tabindex:E?0:void 0,onClick:a},{default:()=>{var p;return[m(),i(),c(),v(),(p=n.extra)==null?void 0:p.call(n)]}})}}});const ze=le(Tt);function Fe(e){return Array.isArray(e)?!e.length:e===0?!1:!e}function Vt(e,n){if(Fe(e)){if(n.required)return!1;if(n.validateEmpty===!1)return!0}return!(n.pattern&&!n.pattern.test(String(e)))}function Et(e,n){return new Promise(a=>{const u=n.validator(e,n);if(et(u)){u.then(a);return}a(u)})}function Ve(e,n){const{message:a}=n;return tt(a)?a(e,n):a||""}function Lt({target:e}){e.composing=!0}function Ee({target:e}){e.composing&&(e.composing=!1,e.dispatchEvent(new Event("input")))}function At(e,n){const a=Ce();e.style.height="auto";let u=e.scrollHeight;if(Ze(n)){const{maxHeight:i,minHeight:c}=n;i!==void 0&&(u=Math.min(u,i)),c!==void 0&&(u=Math.max(u,c))}u&&(e.style.height=`${u}px`,Le(a))}function Rt(e){return e==="number"?{type:"text",inputmode:"decimal"}:e==="digit"?{type:"tel",inputmode:"numeric"}:{type:e}}function K(e){return[...e].length}function fe(e,n){return[...e].slice(0,n).join("")}const[$t,L]=ae("field"),Ie={id:String,name:String,leftIcon:String,rightIcon:String,autofocus:Boolean,clearable:Boolean,maxlength:H,formatter:Function,clearIcon:U("clear"),modelValue:nt(""),inputAlign:String,placeholder:String,autocomplete:String,errorMessage:String,enterkeyhint:String,clearTrigger:U("focus"),formatTrigger:U("onChange"),error:{type:Boolean,default:null},disabled:{type:Boolean,default:null},readonly:{type:Boolean,default:null}},Pt=oe({},Ne,Ie,{rows:H,type:U("text"),rules:Array,autosize:[Boolean,Object],labelWidth:H,labelClass:se,labelAlign:String,showWordLimit:Boolean,errorMessageAlign:String,colon:{type:Boolean,default:null}});var pt=ie({name:$t,props:Pt,emits:["blur","focus","clear","keypress","clickInput","endValidate","startValidate","clickLeftIcon","clickRightIcon","update:modelValue"],setup(e,{emit:n,slots:a}){const u=Oe(),i=Ae({status:"unvalidated",focused:!1,validateMessage:""}),c=N(),m=N(),v=N(),{parent:o}=Re(at),h=()=>{var t;return String((t=e.modelValue)!=null?t:"")},s=t=>{if(O(e[t]))return e[t];if(o&&O(o.props[t]))return o.props[t]},I=D(()=>{const t=s("readonly");if(e.clearable&&!t){const g=h()!=="",d=e.clearTrigger==="always"||e.clearTrigger==="focus"&&i.focused;return g&&d}return!1}),b=D(()=>v.value&&a.input?v.value():e.modelValue),x=t=>t.reduce((g,d)=>g.then(()=>{if(i.status==="failed")return;let{value:_}=b;if(d.formatter&&(_=d.formatter(_,d)),!Vt(_,d)){i.status="failed",i.validateMessage=Ve(_,d);return}if(d.validator)return Fe(_)&&d.validateEmpty===!1?void 0:Et(_,d).then(k=>{k&&typeof k=="string"?(i.status="failed",i.validateMessage=k):k===!1&&(i.status="failed",i.validateMessage=Ve(_,d))})}),Promise.resolve()),S=()=>{i.status="unvalidated",i.validateMessage=""},E=()=>n("endValidate",{status:i.status,message:i.validateMessage}),P=(t=e.rules)=>new Promise(g=>{S(),t?(n("startValidate"),x(t).then(()=>{i.status==="failed"?(g({name:e.name,message:i.validateMessage}),E()):(i.status="passed",g(),E())})):g()}),p=t=>{if(o&&e.rules){const{validateTrigger:g}=o.props,d=we(g).includes(t),_=e.rules.filter(k=>k.trigger?we(k.trigger).includes(t):d);_.length&&P(_)}},G=t=>{var g;const{maxlength:d}=e;if(O(d)&&K(t)>d){const _=h();if(_&&K(_)===+d)return _;const k=(g=c.value)==null?void 0:g.selectionEnd;if(i.focused&&k){const V=[...t],$=V.length-+d;return V.splice(k-$,$),V.join("")}return fe(t,+d)}return t},z=(t,g="onChange")=>{const d=t;t=G(t);const _=K(d)-K(t);if(e.type==="number"||e.type==="digit"){const V=e.type==="number";t=lt(t,V,V)}let k=0;if(e.formatter&&g===e.formatTrigger){const{formatter:V,maxlength:$}=e;if(t=V(t),O($)&&K(t)>$&&(t=fe(t,+$)),c.value&&i.focused){const{selectionEnd:re}=c.value,Se=fe(d,re);k=K(V(Se))-K(Se)}}if(c.value&&c.value.value!==t)if(i.focused){let{selectionStart:V,selectionEnd:$}=c.value;if(c.value.value=t,O(V)&&O($)){const re=K(t);_?(V-=_,$-=_):k&&(V+=k,$+=k),c.value.setSelectionRange(Math.min(V,re),Math.min($,re))}}else c.value.value=t;t!==e.modelValue&&n("update:modelValue",t)},Q=t=>{t.target.composing||z(t.target.value)},r=()=>{var t;return(t=c.value)==null?void 0:t.blur()},Y=()=>{var t;return(t=c.value)==null?void 0:t.focus()},F=()=>{const t=c.value;e.type==="textarea"&&e.autosize&&t&&At(t,e.autosize)},f=t=>{i.focused=!0,n("focus",t),ee(F),s("readonly")&&r()},y=t=>{s("readonly")||(i.focused=!1,z(h(),"onBlur"),n("blur",t),p("onBlur"),ee(F),st())},C=t=>n("clickInput",t),T=t=>n("clickLeftIcon",t),w=t=>n("clickRightIcon",t),B=t=>{ue(t),n("update:modelValue",""),n("clear",t)},j=D(()=>{if(typeof e.error=="boolean")return e.error;if(o&&o.props.showError&&i.status==="failed")return!0}),M=D(()=>{const t=s("labelWidth");if(t)return{width:ot(t)}}),R=t=>{t.keyCode===13&&(!(o&&o.props.submitOnEnter)&&e.type!=="textarea"&&ue(t),e.type==="search"&&r()),n("keypress",t)},ce=()=>e.id||`${u}-input`,W=()=>i.status,qe=()=>{const t=L("control",[s("inputAlign"),{error:j.value,custom:!!a.input,"min-height":e.type==="textarea"&&!e.autosize}]);if(a.input)return l("div",{class:t,onClick:C},[a.input()]);const g={id:ce(),ref:c,name:e.name,rows:e.rows!==void 0?+e.rows:void 0,class:t,disabled:s("disabled"),readonly:s("readonly"),autofocus:e.autofocus,placeholder:e.placeholder,autocomplete:e.autocomplete,enterkeyhint:e.enterkeyhint,"aria-labelledby":e.label?`${u}-label`:void 0,onBlur:y,onFocus:f,onInput:Q,onClick:C,onChange:Ee,onKeypress:R,onCompositionend:Ee,onCompositionstart:Lt};return e.type==="textarea"?l("textarea",g,null):l("input",Pe(Rt(e.type),g),null)},He=()=>{const t=a["left-icon"];if(e.leftIcon||t)return l("div",{class:L("left-icon"),onClick:T},[t?t():l(te,{name:e.leftIcon,classPrefix:e.iconPrefix},null)])},We=()=>{const t=a["right-icon"];if(e.rightIcon||t)return l("div",{class:L("right-icon"),onClick:w},[t?t():l(te,{name:e.rightIcon,classPrefix:e.iconPrefix},null)])},Ue=()=>{if(e.showWordLimit&&e.maxlength){const t=K(h());return l("div",{class:L("word-limit")},[l("span",{class:L("word-num")},[t]),rt("/"),e.maxlength])}},Ge=()=>{if(o&&o.props.showErrorMessage===!1)return;const t=e.errorMessage||i.validateMessage;if(t){const g=a["error-message"],d=s("errorMessageAlign");return l("div",{class:L("error-message",d)},[g?g({message:t}):t])}},Ye=()=>{const t=s("colon")?":":"";if(a.label)return[a.label(),t];if(e.label)return l("label",{id:`${u}-label`,for:ce()},[e.label+t])},Xe=()=>[l("div",{class:L("body")},[qe(),I.value&&l(te,{ref:m,name:e.clearIcon,class:L("clear")},null),We(),a.button&&l("div",{class:L("button")},[a.button()])]),Ue(),Ge()];return de({blur:r,focus:Y,validate:P,formValue:b,resetValidation:S,getValidationStatus:W}),it(ct,{customValue:v,resetValidation:S,validateWithTrigger:p}),he(()=>e.modelValue,()=>{z(h()),S(),p("onChange"),ee(F)}),$e(()=>{z(h(),e.formatTrigger),ee(F)}),me("touchstart",B,{target:D(()=>{var t;return(t=m.value)==null?void 0:t.$el})}),()=>{const t=s("disabled"),g=s("labelAlign"),d=He(),_=()=>{const k=Ye();return g==="top"?[d,k].filter(Boolean):k||[]};return l(ze,{size:e.size,class:L({error:j.value,disabled:t,[`label-${g}`]:g}),center:e.center,border:e.border,isLink:e.isLink,clickable:e.clickable,titleStyle:M.value,valueClass:L("value"),titleClass:[L("label",[g,{required:e.required}]),e.labelClass],arrowDirection:e.arrowDirection},{icon:d&&g!=="top"?()=>d:null,title:_,value:Xe,extra:a.extra})}}});const Bt=le(pt);function Mt(){const e="A".charCodeAt(0);return Array(26).fill("").map((a,u)=>String.fromCharCode(e+u))}const[je,ge]=ae("index-bar"),Ot={sticky:ke,zIndex:H,teleport:[String,Object],highlightColor:String,stickyOffsetTop:gt(0),indexList:{type:Array,default:Mt}},Ke=Symbol(je);var Dt=ie({name:je,props:Ot,emits:["select","change"],setup(e,{emit:n,slots:a}){const u=N(),i=N(),c=N(""),m=It(),v=ut(u),{children:o,linkChildren:h}=dt(Ke);let s;h({props:e});const I=D(()=>{if(O(e.zIndex))return{zIndex:+e.zIndex+1}}),b=D(()=>{if(e.highlightColor)return{color:e.highlightColor}}),x=(f,y)=>{for(let C=o.length-1;C>=0;C--){const T=C>0?y[C-1].height:0,w=e.sticky?T+e.stickyOffsetTop:0;if(f+w>=y[C].top)return C}return-1},S=f=>o.find(y=>String(y.index)===f),E=()=>{if(ht(u))return;const{sticky:f,indexList:y}=e,C=ve(v.value),T=be(v),w=o.map(j=>j.getRect(v.value,T));let B=-1;if(s){const j=S(s);if(j){const M=j.getRect(v.value,T);B=x(M.top,w)}}else B=x(C,w);c.value=y[B],f&&o.forEach((j,M)=>{const{state:R,$el:ce}=j;if(M===B||M===B-1){const W=ce.getBoundingClientRect();R.left=W.left,R.width=W.width}else R.left=null,R.width=null;if(M===B)R.active=!0,R.top=Math.max(e.stickyOffsetTop,w[M].top-C)+T.top;else if(M===B-1&&s===""){const W=w[B].top-C;R.active=W>0,R.top=W+T.top-w[M].height}else R.active=!1}),s=""},P=()=>{ee(E)};me("scroll",E,{target:v,passive:!0}),$e(P),he(()=>e.indexList,P),he(c,f=>{f&&n("change",f)});const p=()=>e.indexList.map(f=>{const y=f===c.value;return l("span",{class:ge("index",{active:y}),style:y?b.value:void 0,"data-index":f},[f])}),G=f=>{s=String(f);const y=S(s);if(y){const C=ve(v.value),T=be(v),{offsetHeight:w}=document.documentElement;if(y.$el.scrollIntoView(),C===w-T.height){E();return}e.sticky&&e.stickyOffsetTop&&Le(Ce()-e.stickyOffsetTop),n("select",y.index)}},z=f=>{const{index:y}=f.dataset;y&&G(y)},Q=f=>{z(f.target)};let r;const Y=f=>{if(m.move(f),m.isVertical()){ue(f);const{clientX:y,clientY:C}=f.touches[0],T=document.elementFromPoint(y,C);if(T){const{index:w}=T.dataset;w&&r!==w&&(r=w,z(T))}}},F=()=>l("div",{ref:i,class:ge("sidebar"),style:I.value,onClick:Q,onTouchstartPassive:m.start},[p()]);return de({scrollTo:G}),me("touchmove",Y,{target:i}),()=>{var f;return l("div",{ref:u,class:ge()},[e.teleport?l(ft,{to:e.teleport},{default:()=>[F()]}):F(),(f=a.default)==null?void 0:f.call(a)])}}});const[Nt,zt]=ae("index-anchor"),Ft={index:H};var jt=ie({name:Nt,props:Ft,setup(e,{slots:n}){const a=Ae({top:0,left:null,rect:{top:0,height:0},width:null,active:!1}),u=N(),{parent:i}=Re(Ke);if(!i)return;const c=()=>a.active&&i.props.sticky,m=D(()=>{const{zIndex:o,highlightColor:h}=i.props;if(c())return oe(mt(o),{left:a.left?`${a.left}px`:void 0,width:a.width?`${a.width}px`:void 0,transform:a.top?`translate3d(0, ${a.top}px, 0)`:void 0,color:h})});return de({state:a,getRect:(o,h)=>{const s=be(u);return a.rect.height=s.height,o===window||o===document.body?a.rect.top=s.top+Ce():a.rect.top=s.top+ve(o)-h.top,a.rect}}),()=>{const o=c();return l("div",{ref:u,style:{height:o?`${a.rect.height}px`:void 0}},[l("div",{style:m.value,class:[zt({sticky:o}),{[vt]:o}]},[n.default?n.default():e.index])])}}});const Kt=le(jt),qt=le(Dt),[Ht,Z,Wt]=ae("search"),Ut=oe({},Ie,{label:String,shape:U("square"),leftIcon:U("search"),clearable:ke,actionText:String,background:String,showAction:Boolean});var Gt=ie({name:Ht,props:Ut,emits:["blur","focus","clear","search","cancel","clickInput","clickLeftIcon","clickRightIcon","update:modelValue"],setup(e,{emit:n,slots:a,attrs:u}){const i=Oe(),c=N(),m=()=>{a.action||(n("update:modelValue",""),n("cancel"))},v=r=>{r.keyCode===13&&(ue(r),n("search",e.modelValue))},o=()=>e.id||`${i}-input`,h=()=>{if(a.label||e.label)return l("label",{class:Z("label"),for:o()},[a.label?a.label():e.label])},s=()=>{if(e.showAction){const r=e.actionText||Wt("cancel");return l("div",{class:Z("action"),role:"button",tabindex:0,onClick:m},[a.action?a.action():r])}},I=()=>{var r;return(r=c.value)==null?void 0:r.blur()},b=()=>{var r;return(r=c.value)==null?void 0:r.focus()},x=r=>n("blur",r),S=r=>n("focus",r),E=r=>n("clear",r),P=r=>n("clickInput",r),p=r=>n("clickLeftIcon",r),G=r=>n("clickRightIcon",r),z=Object.keys(Ie),Q=()=>{const r=oe({},u,Te(e,z),{id:o()}),Y=F=>n("update:modelValue",F);return l(Bt,Pe({ref:c,type:"search",class:Z("field"),border:!1,onBlur:x,onFocus:S,onClear:E,onKeypress:v,onClickInput:P,onClickLeftIcon:p,onClickRightIcon:G,"onUpdate:modelValue":Y},r),Te(a,["left-icon","right-icon"]))};return de({focus:b,blur:I}),()=>{var r;return l("div",{class:Z({"show-action":e.showAction}),style:{background:e.background}},[(r=a.left)==null?void 0:r.call(a),l("div",{class:Z("content",e.shape)},[h(),Q()]),s()])}}});const Yt=le(Gt);const Xt={class:"city-group"},Jt={class:"list"},Qt=["onClick"],Zt={__name:"city-group",props:{groupData:{type:Object,default:()=>({})}},setup(e){const n=e,a=D(()=>{const m=n.groupData.cities.map(v=>v.group);return m.unshift("#"),m}),u=Be(),i=De(),c=m=>{console.log(m),i.currentCity=m,u.back()};return(m,v)=>{const o=Kt,h=ze,s=qt;return A(),q("div",Xt,[l(s,{"index-list":xe(a)},{default:Me(()=>[l(o,{index:"热门"}),ye("div",Jt,[(A(!0),q(J,null,ne(e.groupData.hotCities,(I,b)=>(A(),q("div",{key:b,class:"city",onClick:x=>c(I)},bt(I.cityName),9,Qt))),128))]),(A(!0),q(J,null,ne(e.groupData.cities,(I,b)=>(A(),q(J,{key:b},[l(o,{index:I.group},null,8,["index"]),(A(!0),q(J,null,ne(I.cities,(x,S)=>(A(),_e(h,{key:S,title:x.cityName,onClick:E=>c(x)},null,8,["title","onClick"]))),128))],64))),128))]),_:1},8,["index-list"])])}}},en=pe(Zt,[["__scopeId","data-v-ded56293"]]);const tn={class:"city top-page"},nn={class:"top"},an={class:"content"},on={__name:"city",setup(e){const n=Be(),a=N(""),u=()=>{n.back()},i=N(),c=De();c.fetchAllCitiesData();const{allCities:m}=yt(c);return D(()=>m.value[i.value]),(v,o)=>{const h=Yt,s=kt,I=Ct;return A(),q("div",tn,[ye("div",nn,[l(h,{shape:"round","show-action":"",modelValue:a.value,"onUpdate:modelValue":o[0]||(o[0]=b=>a.value=b),placeholder:"城市/区域/位置",onCancel:u},null,8,["modelValue"]),l(I,{active:i.value,"onUpdate:active":o[1]||(o[1]=b=>i.value=b),color:"#ff9854","line-height":"2"},{default:Me(()=>[(A(!0),q(J,null,ne(xe(m),(b,x,S)=>(A(),_e(s,{key:x,title:b.title,name:x},null,8,["title","name"]))),128))]),_:1},8,["active"])]),ye("div",an,[(A(!0),q(J,null,ne(xe(m),(b,x,S)=>_t((A(),_e(en,{key:x,"group-data":b},null,8,["group-data"])),[[xt,x===i.value]])),128))])])}}},sn=pe(on,[["__scopeId","data-v-b34099d9"]]);export{sn as default};
